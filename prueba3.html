<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cotiza tus C√≥cteles</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
</head>
<body class="bg-light">
  <div id="app" class="container py-4">
    <h1 class="text-center mb-4 fs-4">Cotiza tus C√≥cteles</h1>
    
    <div class="alert alert-info mb-4 small">
      <p class="mb-1"><strong>Servicio incluido por la compra del Barril:</strong> Estaci√≥n de Cocteler√≠a con M√°quina Dispensadora, Cristaler√≠a, Bombillas, Hielo, Decoraciones para los C√≥cteles. Despacho y Retiro Gratis en Santiago.</p>
      <hr>
      <p class="mb-1"><strong>*Cada barril de 5L rinde 25-30 c√≥cteles</strong></p>
      <p class="mb-0"><strong>*Cada barril de 10L rinde 50-60 c√≥cteles</strong></p>
    </div>

    <div class="row row-cols-2 g-3 mb-4">
      <div v-for="(producto, index) in productos" :key="index" class="col">
        <div class="card h-100" :class="{ 'border-primary bg-light': producto.cantidad > 0 }" @click="toggleCantidad(producto, $event)">
          <div class="card-body p-3">
            <div class="d-flex justify-content-between align-items-center">
              <h6 class="card-title fw-bold mb-0 fs-6">{{ producto.nombre }}</h6>
              <span :class="{ 'fw-bold': producto.cantidad > 0, 'text-muted': producto.cantidad < 1 }" class="fs-6">
                ${{ producto.cantidad > 0 ? formatPrice(producto.subtotal) : 0 }}
              </span>
            </div>
            <p class="card-text text-muted small mb-1">{{ producto.descripcion }}</p>
            
            <select class="form-select form-select-sm mb-2" v-model="producto.tamanoSeleccionado" @change="calcularSubtotal(producto)">
              <option v-for="tamano in producto.tamanos" :key="tamano.id" :value="tamano">
                {{ tamano.nombre }} - ${{ formatPrice(tamano.precio) }}
              </option>
            </select>
            
            <div class="d-flex align-items-center gap-2">
              <button class="btn btn-outline-primary btn-sm py-0 px-2" @click.stop="decrementarCantidad(producto)" :disabled="producto.cantidad <= 0">-</button>
              <input type="text" class="form-control form-control-sm text-center px-1" v-model.number="producto.cantidad" @input="validarCantidad(producto)">
              <button class="btn btn-outline-primary btn-sm py-0 px-2" @click.stop="incrementarCantidad(producto)">+</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- El resto del c√≥digo se mantiene igual desde el formulario de contacto hacia abajo -->
    <!-- ... (mantener mismo c√≥digo del formulario y resumen de la versi√≥n anterior) ... -->
    <div class="row g-4">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <form @submit.prevent="enviarCotizacion">
              <h5 class="card-title mb-3">Datos de Contacto</h5>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <input type="datetime-local" class="form-control form-control-sm" v-model="datosContacto.fechaHora" required>
                </div>
                <div class="col-md-6 mb-3">
                  <input type="number" class="form-control form-control-sm" placeholder="Cantidad de Invitados" v-model="datosContacto.invitados" required>
                </div>
                <div class="col-md-6 mb-3">
                  <input type="text" class="form-control form-control-sm" placeholder="Direcci√≥n y Comuna" v-model="datosContacto.direccion" required>
                </div>
                <div class="col-md-6 mb-3">
                  <input type="text" class="form-control form-control-sm" placeholder="Nombre y Apellidos" v-model="datosContacto.nombre" required>
                </div>
                <div class="col-md-6 mb-3">
                  <input type="tel" class="form-control form-control-sm" placeholder="Celular (+569-12345678)" v-model="datosContacto.telefono" required>
                </div>
                <div class="col-md-6 mb-3">
                  <input type="email" class="form-control form-control-sm" placeholder="E-mail" v-model="datosContacto.email" required>
                </div>
                <div class="col-12 mb-3">
                  <textarea class="form-control form-control-sm" placeholder="Comentarios" rows="2" v-model="datosContacto.comentarios"></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-3">Resumen</h5>
            <div v-if="productosSeleccionados.length > 0">
              <div v-for="(producto, index) in productosSeleccionados" :key="index" class="d-flex justify-content-between small mb-2">
                <div>{{ producto.nombre }} ({{ producto.tamanoSeleccionado.nombre }}) √ó {{ producto.cantidad }}</div>
                <div>${{ formatPrice(producto.subtotal) }}</div>
              </div>
              <hr class="my-2">
              <div class="d-flex justify-content-between fw-bold small">
                <div>Total</div>
                <div>${{ formatPrice(totalGeneral) }}</div>
              </div>
            </div>
            <div v-else class="text-center text-muted small py-2">Selecciona productos</div>
            <button @click="enviarCotizacion" class="btn btn-success btn-sm w-100 mt-3" :disabled="!productosSeleccionados.length">
              Enviar Cotizaci√≥n
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const { createApp, ref, computed } = Vue;

createApp({
  setup() {
    const productos = ref([
      { nombre: 'Pisco Sour Cl√°sico', descripcion: 'Pisco Transparente, Lim√≥n Sutil, Az√∫car, Alb√∫mina.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 69990 }, { id: 2, nombre: 'Barril 10L', precio: 129990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Caipiri√±a', descripcion: 'Cacha√ßa, Lim√≥n y Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 69990 }, { id: 2, nombre: 'Barril 10L', precio: 129990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Gin and Tonic', descripcion: 'Cacha√ßa, Lim√≥n y Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 79990 }, { id: 2, nombre: 'Barril 10L', precio: 149990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Sangr√≠a', descripcion: 'Vino Tinto CS, Triple Sec, Destilado A√±ejado, Naranja, Lim√≥n.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 79990 }, { id: 2, nombre: 'Barril 10L', precio: 149990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Mojito Tradicional', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Lim√≥n, Menta, Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 79990 }, { id: 2, nombre: 'Barril 10L', precio: 149990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Mojito Frambuesa', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Frambuesa, Lim√≥n, Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 84990 }, { id: 2, nombre: 'Barril 10L', precio: 159990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Mojito Maracuy√°', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Maracuy√°, Lim√≥n, Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 84990 }, { id: 2, nombre: 'Barril 10L', precio: 159990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Ramazzotti Spritz', descripcion: 'Ramazzotti, Espumante Brut, Agua Mineral Gasificada.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 99990 }, { id: 2, nombre: 'Barril 10L', precio: 189990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Aperol Spritz', descripcion: 'Aperol, Espumante Brut, Agua Mineral Gasificada.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 99990 }, { id: 2, nombre: 'Barril 10L', precio: 189990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Tequila Margarita', descripcion: 'Tequila Blanco, Triple Sec, Lim√≥n, Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 99990 }, { id: 2, nombre: 'Barril 10L', precio: 189990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Tropical Gin', descripcion: 'Gin, Red Bull Tropical.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 99990 }, { id: 2, nombre: 'Barril 10L', precio: 189990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 },
      { nombre: 'Mojito Sin Alcohol', descripcion: 'Agua Mineral, Lim√≥n, Menta, Az√∫car.',
        tamanos: [{ id: 1, nombre: 'Barril 5L', precio: 59990 }, { id: 2, nombre: 'Barril 10L', precio: 110990 }],
        tamanoSeleccionado: null, cantidad: 0, subtotal: 0 }
    ].map(p => ({ ...p, tamanoSeleccionado: p.tamanos[0] })));

    const datosContacto = ref({ fechaHora: '', invitados: '', direccion: '', nombre: '', telefono: '', email: '', comentarios: '' });

    const productosSeleccionados = computed(() => productos.value.filter(p => p.cantidad > 0));
    const totalGeneral = computed(() => productosSeleccionados.value.reduce((t, p) => t + p.subtotal, 0));

    const formatPrice = price => new Intl.NumberFormat('es-CL').format(price);
    const calcularSubtotal = producto => producto.subtotal = producto.tamanoSeleccionado.precio * producto.cantidad;
    const validarCantidad = producto => producto.cantidad = Math.max(0, parseInt(producto.cantidad) || 0);
    const incrementarCantidad = producto => { producto.cantidad++; calcularSubtotal(producto); };
    const decrementarCantidad = producto => { producto.cantidad > 0 && (producto.cantidad--, calcularSubtotal(producto)); };
    const toggleCantidad = (producto, event) => {
      if (event.target.closest('button, input, select')) return;
      producto.cantidad = producto.cantidad > 0 ? 0 : 1;
      calcularSubtotal(producto);
    };

    const enviarCotizacion = () => {
      if (!productosSeleccionados.value.length) return alert('Selecciona al menos un producto');
      if (!document.querySelector('form').reportValidity()) return;
      
      const mensaje = `*Cotizaci√≥n de C√≥cteles*\n\n*Datos del Evento:*\nüìÖ Fecha y Hora: ${datosContacto.value.fechaHora}\nüë• Invitados: ${datosContacto.value.invitados}\nüìç Direcci√≥n: ${datosContacto.value.direccion}\nüë§ Nombre: ${datosContacto.value.nombre}\nüì± Tel√©fono: ${datosContacto.value.telefono}\nüìß Email: ${datosContacto.value.email}` +
        `${datosContacto.value.comentarios ? `\nüí¨ Comentarios: ${datosContacto.value.comentarios}` : ''}\n\n*Productos Seleccionados:*\n${productosSeleccionados.value.map(p => `‚Ä¢ ${p.nombre} (${p.tamanoSeleccionado.nombre}) √ó ${p.cantidad}: $${formatPrice(p.subtotal)}`).join('\n')}` +
        `\n\n*Total: $${formatPrice(totalGeneral.value)}*`;
      
      window.open(`https://wa.me/?text=${encodeURIComponent(mensaje)}`, '_blank');
    };

    return { productos, datosContacto, productosSeleccionados, totalGeneral, formatPrice, incrementarCantidad, decrementarCantidad, validarCantidad, calcularSubtotal, enviarCotizacion, toggleCantidad };
  }
}).mount('#app');
</script>
</body>
</html>