<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotización de Cócteles</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        .floating-form {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 300px;
            z-index: 1000;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container py-4">
            <h2>Cotiza tus Cócteles</h2>
            <p class="lead">Selecciona la cantidad deseada de cada cóctel.</p>

            <div class="row row-cols-1 row-cols-md-2 g-4 mb-3">
                <div v-for="(producto, index) in productos" :key="index" class="col">
                    <div class="card h-100">
                        <div class="card-body">
                            <h6 class="fw-bold">{{ producto.nombre }}</h6>
                            <p class="text-muted small">{{ producto.descripcion }}</p>
                            <p class="mb-1">Barril 5L - ${{ producto.precio.toLocaleString('es-CL') }}</p>
                            <div class="d-flex gap-2 align-items-center">
                                <button type="button" class="btn btn-outline-secondary btn-sm" @click="decrementarCantidad(producto)">-</button>
                                <input
                                    type="number"
                                    class="form-control form-control-sm text-center"
                                    v-model.number="producto.cantidad"
                                    @input="validarCantidad(producto)"
                                    min="0"
                                >
                                <button type="button" class="btn btn-outline-secondary btn-sm" @click="incrementarCantidad(producto)">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <h3 class="mt-4">Formulario de Contacto</h3>
            <form @submit.prevent="enviarCotizacionWhatsApp" class="row g-3">
                <div class="col-md-6">
                    <label for="fechaHora" class="form-label">Fecha y Hora:</label>
                    <input type="datetime-local" class="form-control form-control-sm" id="fechaHora" v-model="formData.fechaHora">
                </div>
                <div class="col-md-6">
                    <label for="invitados" class="form-label">Cantidad de Invitados:</label>
                    <input type="number" class="form-control form-control-sm" id="invitados" v-model="formData.invitados">
                </div>
                <div class="col-md-6">
                    <label for="direccion" class="form-label">Dirección:</label>
                    <input type="text" class="form-control form-control-sm" id="direccion" v-model="formData.direccion">
                </div>
                <div class="col-md-6">
                    <label for="comuna" class="form-label">Comuna:</label>
                    <input type="text" class="form-control form-control-sm" id="comuna" v-model="formData.comuna">
                </div>
                <div class="col-md-6">
                    <label for="nombreContacto" class="form-label">Nombre y Apellidos:</label>
                    <input type="text" class="form-control form-control-sm" id="nombreContacto" v-model="formData.nombreContacto" required>
                </div>
                <div class="col-md-6">
                    <label for="telefonoContacto" class="form-label">Celular:</label>
                    <div class="input-group input-group-sm">
                        <span class="input-group-text">+569</span>
                        <input type="tel" class="form-control" id="telefonoContacto" v-model="formData.telefonoContacto" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <label for="emailContacto" class="form-label">E-mail:</label>
                    <input type="email" class="form-control form-control-sm" id="emailContacto" v-model="formData.emailContacto">
                </div>
                <div class="col-12">
                    <label for="comentarios" class="form-label">Comentarios:</label>
                    <textarea class="form-control form-control-sm" id="comentarios" rows="3" v-model="formData.comentarios"></textarea>
                </div>
                <div class="col-12 mt-3">
                    <button type="submit" class="btn btn-success">Enviar Cotización</button>
                </div>
            </form>

            <div class="mt-4">
                <h3>Resumen</h3>
                <p v-if="productosSeleccionados.length > 0">Productos seleccionados: {{ productosSeleccionados.length }}</p>
                <p v-else>Selecciona productos.</p>
            </div>
        </div>

        <div v-if="productosSeleccionados.length > 0" class="floating-form bg-light p-3 rounded shadow">
            <h5 class="mb-2">Tu Selección:</h5>
            <ul class="list-unstyled">
                <li v-for="producto in productosSeleccionados" :key="producto.nombre" class="mb-1">
                    {{ producto.nombre }}: {{ producto.cantidad }}
                </li>
            </ul>
            <p class="fw-bold mb-0">Total: ${{ totalGeneral.toLocaleString('es-CL') }}</p>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script type="text/javascript">
        const { createApp, ref, computed, reactive } = Vue;

        createApp({
            setup() {
                const productosData = [
                    { nombre: 'Pisco Sour Clásico', descripcion: 'Pisco Transparente, Limón Sutil, Azúcar, Albumina.', precio: 69990, cantidad: 0 },
                    { nombre: 'Caipiriña', descripcion: 'Cachaza, Limón y Azúcar.', precio: 69990, cantidad: 0 },
                    { nombre: 'Gin and Tonic', descripcion: 'Gin, Agua Tónica.', precio: 79990, cantidad: 0 },
                    { nombre: 'Sangría', descripcion: 'Vino Tinto CS, Triple Sec, Destilado Añejo, Naranja, Limón.', precio: 79990, cantidad: 0 },
                    { nombre: 'Mojito Tradicional', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Limón, Menta, Azúcar.', precio: 79990, cantidad: 0 },
                    { nombre: 'Mojito Frambuesa', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Frambuesa, Limón, Azúcar.', precio: 84990, cantidad: 0 },
                    { nombre: 'Mojito Maracuyá', descripcion: 'Ron Blanco, Agua Mineral Gasificada, Maracuyá, Limón, Azúcar.', precio: 84990, cantidad: 0 },
                    { nombre: 'Ramazzotti Spritz', descripcion: 'Ramazzotti, Espumante Brut, Agua Mineral Gasificada.', precio: 99990, cantidad: 0 },
                    { nombre: 'Aperol Spritz', descripcion: 'Aperol, Espumante Brut, Agua Mineral Gasificada.', precio: 99990, cantidad: 0 },
                    { nombre: 'Tequila Margarita', descripcion: 'Tequila Blanco, Triple Sec, Limón, Azúcar.', precio: 99990, cantidad: 0 },
                    { nombre: 'Tropical Gin', descripcion: 'Gin, Red Bull Tropical.', precio: 99990, cantidad: 0 },
                    { nombre: 'Mojito Sin Alcohol', descripcion: 'Agua Mineral, Limón, Menta, Azúcar.', precio: 59990, cantidad: 0 },
                ];

                const productos = ref(productosData);
                const formData = reactive({
                    fechaHora: '',
                    invitados: '',
                    direccion: '',
                    comuna: '',
                    nombreContacto: '',
                    emailContacto: '',
                    telefonoContacto: '',
                    comentarios: '',
                });

                const productosSeleccionados = computed(() => {
                    return productos.value.filter(producto => producto.cantidad > 0);
                });

                const totalGeneral = computed(() => {
                    return productosSeleccionados.value.reduce((total, producto) => {
                        return total + producto.precio * producto.cantidad;
                    }, 0);
                });

                const incrementarCantidad = (producto) => {
                    producto.cantidad++;
                };

                const decrementarCantidad = (producto) => {
                    if (producto.cantidad > 0) {
                        producto.cantidad--;
                    }
                };

                const validarCantidad = (producto) => {
                    if (producto.cantidad < 0) {
                        producto.cantidad = 0;
                    }
                };

                const enviarCotizacionWhatsApp = () => {
                    if (!formData.nombreContacto || !formData.telefonoContacto) {
                        alert('Por favor, completa los campos obligatorios (Nombre y Apellidos, Celular).');
                        return;
                    }

                    let mensaje = `¡Hola! Quiero solicitar una cotización de cócteles:\n\n`;
                    mensaje += `*Datos del Contacto:*\n`;
                    mensaje += `Nombre y Apellidos: ${formData.nombreContacto}\n`;
                    mensaje += `Celular: +569${formData.telefonoContacto}\n`;
                    if (formData.emailContacto) {
                        mensaje += `E-mail: ${formData.emailContacto}\n`;
                    }
                    mensaje += `\n*Detalles del Evento:*\n`;
                    if (formData.fechaHora) {
                        mensaje += `Fecha y Hora: ${formData.fechaHora}\n`;
                    }
                    if (formData.invitados) {
                        mensaje += `Cantidad de Invitados: ${formData.invitados}\n`;
                    }
                    if (formData.direccion) {
                        mensaje += `Dirección: ${formData.direccion}\n`;
                    }
                    if (formData.comuna) {
                        mensaje += `Comuna: ${formData.comuna}\n`;
                    }
                    if (formData.comentarios) {
                        mensaje += `Comentarios: ${formData.comentarios}\n`;
                    }
                    mensaje += `\n*Productos Seleccionados:*\n`;

                    if (productosSeleccionados.value.length > 0) {
                        productosSeleccionados.value.forEach(producto => {
                            mensaje += `- ${producto.nombre} - Cantidad: ${producto.cantidad} - Subtotal: $${(producto.precio * producto.cantidad).toLocaleString('es-CL')}\n`;
                        });
                        mensaje += `\n*Total General Estimado: $${totalGeneral.value.toLocaleString('es-CL')}*\n`;
                    } else {
                        mensaje += `No se han seleccionado productos.\n`;
                    }

                    const telefonoWhatsApp = '+569XXXXXXXXX'; // Reemplaza con el número de teléfono de tu negocio
                    const urlWhatsApp = `https://wa.me/${telefonoWhatsApp}?text=${encodeURIComponent(mensaje)}`;
                    window.open(urlWhatsApp, '_blank');
                };

                return {
                    productos,
                    formData,
                    productosSeleccionados,
                    totalGeneral,
                    incrementarCantidad,
                    decrementarCantidad,
                    validarCantidad,
                    enviarCotizacionWhatsApp,
                };
            },
            template: `
                <div>
                    <div class="container py-4">
                        <h2>Cotiza tus Cócteles</h2>
                        <p class="lead">Selecciona la cantidad deseada de cada cóctel.</p>

                        <div class="row row-cols-1 row-cols-md-2 g-4 mb-3">
                            <div v-for="(producto, index) in productos" :key="index" class="col">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6 class="fw-bold">{{ producto.nombre }}</h6>
                                        <p class="text-muted small">{{ producto.descripcion }}</p>
                                        <p class="mb-1">Barril 5L - ${{ producto.precio.toLocaleString('es-CL') }}</p>
                                        <div class="d-flex gap-2 align-items-center">
                                            <button type="button" class="btn btn-outline-secondary btn-sm" @click="decrementarCantidad(producto)">-</button>
                                            <input
                                                type="number"
                                                class="form-control form-control-sm text-center"
                                                v-model.number="producto.cantidad"
                                                @input="validarCantidad(producto)"
                                                min="0"
                                            >
                                            <button type="button" class="btn btn-outline-secondary btn-sm" @click="incrementarCantidad(producto)">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h3 class="mt-4">Formulario de Contacto</h3>
                        <form @submit.prevent="enviarCotizacionWhatsApp" class="row g-3">
                            <div class="col-md-6">
                                <label for="fechaHora" class="form-label">Fecha y Hora:</label>
                                <input type="datetime-local" class="form-control form-control-sm" id="fechaHora" v-model="formData.fechaHora">
                            </div>
                            <div class="col-md-6">
                                <label for="invitados" class="form-label">Cantidad de Invitados:</label>
                                <input type="number" class="form-control form-control-sm" id="invitados" v-model="formData.invitados">
                            </div>
                            <div class="col-md-6">
                                <label for="direccion" class="form-label">Dirección:</label>
                                <input type="text" class="form-control form-control-sm" id="direccion" v-model="formData.direccion">
                            </div>
                            <div class="col-md-6">
                                <label for="comuna" class="form-label">Comuna:</label>
                                <input type="text" class="form-control form-control-sm" id="comuna" v-model="formData.comuna">
                            </div>
                            <div class="col-md-6">
                                <label for="nombreContacto" class="form-label">Nombre y Apellidos:</label>
                                <input type="text" class="form-control form-control-sm" id="nombreContacto" v-model="formData.nombreContacto" required>
                            </div>
                            <div class="col-md-6">
                                <label for="telefonoContacto" class="form-label">Celular:</label>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text">+569</span>
                                    <input type="tel" class="form-control" id="telefonoContacto" v-model="formData.telefonoContacto" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="emailContacto" class="form-label">E-mail:</label>
                                <input type="email" class="form-control form-control-sm" id="emailContacto" v-model="formData.emailContacto">
                            </div>
                            <div class="col-12">
                                <label for="comentarios" class="form-label">Comentarios:</label>
                                <textarea class="form-control form-control-sm" id="comentarios" rows="3" v-model="formData.comentarios"></textarea>
                            </div>
                            <div class="col-12 mt-3">
                                <button type="submit" class="btn btn-success">Enviar Cotización</button>
                            </div>
                        </form>

                        <div class="mt-4">
                            <h3>Resumen</h3>
                            <p v-if="productosSeleccionados.length > 0">Productos seleccionados: {{ productosSeleccionados.length }}</p>
                            <p v-else>Selecciona productos.</p>
                        </div>
                    </div>

                    <div v-if="productosSeleccionados.length > 0" class="floating-form bg-light p-3 rounded shadow">
                        <h5 class="mb-2">Tu Selección:</h5>
                        <ul class="list-unstyled">
                            <li v-for="producto in productosSeleccionados" :key="producto.nombre" class="mb-1">
                                {{ producto.nombre }}: {{ producto.cantidad }}
                            </li>
                        </ul>
                        <p class="fw-bold mb-0">Total: ${{ totalGeneral.toLocaleString('es-CL') }}</p>
                    </div>
                </div>
            `
        }).mount('#app');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
